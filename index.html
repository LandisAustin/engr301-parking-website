<!DOCTYPE html>
<html>
<head>
    <title>Parking Garage Occupancy</title>
</head>

<body style="font-family: Arial; text-align: center; margin-top: 50px;">

    <h1>Parking Garage Dashboard</h1>

	<!-- Stats Section -->
    <div style="margin: 30px 0; font-size: 24px;" id="stats">
        Loading…
    </div>
	
	<!-- Progress Bar -->
	<div style="width: 80%; margin: auto; background: #ddd; border-radius: 8px;">
        <div id="progress" style="width: 0%; height: 30px; background: green; border-radius: 8px;"></div>
    </div>

	<!-- Last Updated Timestamp -->
	<div style="margin-top: 15px; font-size: 18px;" id="timestamp">
        —
    </div>

    <!-- Firebase SDK -->
    <script type="module">

        // Import Firebase tools
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // Your web app's Firebase configuration
		const firebaseConfig = {
		  apiKey: "AIzaSyDZQsc7yVMAGUQcmkRPRTDj0RtNXRzzMxI",
		  authDomain: "parking-garage-sensor.firebaseapp.com",
		  databaseURL: "https://parking-garage-sensor-default-rtdb.firebaseio.com",
		  projectId: "parking-garage-sensor",
		  storageBucket: "parking-garage-sensor.firebasestorage.app",
		  messagingSenderId: "942036034143",
		  appId: "1:942036034143:web:60f671fb4049baf439f1ea"
		};
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const rootRef = ref(database, "/");

		
		// Javascript
        onValue(rootRef, (snapshot) => {
		    const data = snapshot.val();
		    const occupancy = data.occupancy || 0;
		    const capacity = data.capacity || 1; // avoid divide‑by‑zero
		    const percent = ((occupancy / capacity) * 100).toFixed(0);
		
		    // Update text
		    document.getElementById("stats").innerText =
		        `${occupancy} / ${capacity} (${percent}%)`;
		
		    // Update progress bar
		    const bar = document.getElementById("progress");
		    bar.style.width = `${percent}%`;
		
		    // Change color based on fill level
		    if (percent < 60) {
		        bar.style.background = "green";
		    } else if (percent < 90) {
		        bar.style.background = "orange";
		    } else {
		        bar.style.background = "red";
		    }
		
		    // Update timestamp
		    const now = new Date();
		    document.getElementById("timestamp").innerText =
		        `Last update: ${now.toLocaleTimeString()}`;
		});

    </script>

</body>

</html>

